# Краткое описание
В рамках расширения платформы InsureTech добавлен новый продукт — онлайн-оформление ОСАГО.
Решение реализовано через выделение отдельного микросервиса osago-aggregator, который взаимодействует со страховыми компаниями через REST API и обрабатывает поступающие предложения асинхронно.

## Компоненты архитектуры 
- osago-aggregator
1) Отвечает за:
    - Отправку заявок в страховые компании (/create)
    - Опрос предложений (/getOffer)
    - Публикацию событий с предложениями (OsagoOfferReceived)

2) Задеплоен в двух экземплярах:
    - В зоне A — активный
    - В зоне B — пассивный (standby, включается при отказе)

3) Хранилище заявок: osago-db (PostgreSQL или Redis)
Используется для:
    - хранения статусов заявок,
    - временного кэширования результатов,

- core-app
    - Принимает запросы от фронтенда
    - Отправляет заявку в osago-aggregator (через REST)
    - Подписан на Kafka-события (OsagoOfferReceived)


### Особенности масштабирования и надёжности
    - Все сервисы задеплоены в двух зонах доступности (Active-Passive).
    - osago-aggregator присутствует и в A, и в B, с failover-переходом.
    - Используется Kafka как асинхронная шина, чтобы избежать блокировок и обеспечить масштабируемость по RPS.

#### Ссылка на draw.io
https://viewer.diagrams.net/?tags=%7B%7D&lightbox=1&highlight=0000ff&edit=_blank&layers=1&nav=1&title=%D0%94%D0%B8%D0%B0%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B0%20%D1%81%20%D0%BD%D0%BE%D0%B2%D1%8B%D0%BC%20%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%BE%D0%BC.drawio&dark=auto#R%3Cmxfile%3E%3Cdiagram%20name%3D%22%D0%A1%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0%20%E2%80%94%201%22%20id%3D%22bx8_xxog-MDYi9NOV8Kx%22%3E7V1bd9q4Fv41rEkeyLJ89yMhSacz7WmmmbVmet4cEOBTghljmmR%2B%2FZFsy0iywIbalg1q1yIgXzDaW3t%2F%2B6qBMX55%2BxD568XncAqXA12bvg2Mu4GuW8By0R888p6OANfORuZRMM3GdgNPwb8wG9Sy0W0whRvmxDgMl3GwZgcn4WoFJzEz5kdR%2BMqeNguX7Leu%2FTksDDxN%2FGVx9K9gGi%2FSUVd3duO%2FwmC%2BIN8MbC898uxPvs%2BjcLvKvm%2BgGw%2FJv%2FTwi0%2Fulf3QzcKfhq%2FUkHE%2FMMZRGMbpu5e3MVziySXTll73sOdo%2FtwRXMVVLpi%2Fzv54m979DZfh6r%2B%2FuvG%2FP8IvQ1fPHi5%2BJxMCp2h%2Bso9hFC%2FCebjyl%2Fe70dvkR0N8Ww192p3zKQzXaBCgwf%2FBOH7PiO1v4xANLeKXZXYUvgXx3%2FjyGyv79I06cveW3Tn58E4%2BrOLonboIf%2FxGH9tdlnwi16W%2FD%2F%2BovfOWDW3CbTSBByYrm6vYj%2BYwPnCenVMXLRsYvkD0POi6CC79OPjBPoefse88P29HQvQmo%2BIRFM0e8oe%2F3ELCmByFWfq9LoIYPq395Ke%2FolXO0iq7HYxi%2BHZ4Bou%2FOLvAsM30klxGZEvidbfggJaNLajFZmkNTRLo4CTpNjtJmmCSHLs4SXZTk%2BQaSjZUlg1mRdmgy5QNpoDt7SV63Ntp8IOhtP3PFuul252SG07CZRgNjBF%2B2vnzlYHYDj2FZoDsr3mdzKjGnQdcNz0BeBp5Y6enki9B7%2BbZ3%2BRh1hEUPswsXMXDmf8SLBEBR7%2F8BuPbyA9WG3Ty53AV%2FoJu%2F4L%2BbtJlmp6%2BSfhshHT22F3H4q9FvOA94Nfb%2B%2BQVjYCBO07eO9S4nrxqydH0vcWcnz0%2BIk3yC%2BT%2BqFMIawAIZpg%2Fb6mx58kznJidotbITGZco2hzV6DKXfKKHjw9bURIhV5d9rTkQl27Sj4D6tYpqQ2KEaz06PVhWqPRZN4LoxXO5SQuUigxKyD9ZTBfofcTJKMgotEtVjsBArSj7MBLMJ0msliktFj53IBy9yrqdsdqSMhZe4UcYrXVEVJuiR92OPWj71doGcySf6kE%2B%2BFHV8PhHCYHs0uSA3gJ6fj%2FtVjCje%2F%2BQ9E9fZ7eEt7lUJ2A8raA8EZTeMWwZeIV8v4bg106i1fsinjF0MRM0A5gcYFMkvYMglYlKTBkktTuoOnFqbDc7pRmnzr1APU%2B4LnR40d0hw9%2BDF%2F99zOHSpzGzNWjLI0JRH4QZRCSr8Xn7%2F%2Fe7Eb4%2Ba31217exsalwxoqiWWRmSUmOYTMCkBsmNzoeKAu4c5JzBhdw99%2FNZpguX1dXETpL2B%2F1XN0GYbJMF9LZLk5spebyDerlpuagxpFTtPyBs%2Fu1aO%2F2WCBUyJplHMEaG7HZJDuSbGo5FtHwKhqHnkyzSNDakC2Z06MyjTdt0zboSl5zE7ZvAZrixi6wOa12gw3AhWdUuhof8zHGxdAjUthk3sqbONm53QpHvcY4WWygFt8I7xQdO1D5M%2F8la%2FQ0j7%2FiGFYcsGSKVUZ98z9rFdVxoYjUxnrImV8pr7Vj6vNNoJ%2FwskC3egv%2BNwpicjMunz1QqcOgCGxhjmdckvpILuQa0DSCtoS6DtJA8ox4yxYLscpp6JrjakP3dkEjW%2FiKPwOqSP2xIXPs3ok%2BhBoFiPSTbMo0oEukOmNwUzdvVADuGp4UJcaHjRV0mF1khLgU65y5fo0NGXZ9VU798Ha7QMUKySZmgXgMCY5h3meoU654LHFKEAlukbOSXMX8%2FsjPYuDgzVCkXMEKC6XdS%2FEJyKbszF8YklWgPpJGtCRpgKdiirQlKoCLVMuVZ1%2B4ZqqRLWkZicCScE0QlWKpNS6LaEqYGi6I3GHqAqAJRWu1pR9d2ZwVc0BxpcRHPrrdSeh%2Bnli5ntRVQ6NdfMQ0IjNdHGoEp4Hqn7rPjs5LdjYIWqDui1dJjSi7mNTcacHFnvTz3nLJM3gV685p%2BBZ4%2FMhsL0b1oVoCbKzddNrE6JbfYTo0sCcVxXM6VK1vqe0vtL6Z671z4wwZ4t8nmJ%2FNX1%2BT2mRgAmTijZ6hVhkHrxMQJKuFRDJAeSEXh0B3KmKoroAa84aAjku6BwCMlVE56LkEboDeuKX9XCDIOoSvsAk2b%2BjylC6zTqiu0cAImHBwKMLLm5ZA5SLCz1QhiYQyWW6rKOKDZoarEoAn5KWWJ7Coouqg5uTvqpsUyHifgvqPrBGHxRz0VCoqHvazQs4a%2F1gk1amnVEQwJCbRDA42j3JRSWdFsOShFrN560nl46iCJfo5yesw2AVb6g7P%2BKBwd5CLcuzOP5I77jjlvzRfgJhiJpo7V2YcirWTLNoBQsr1kBzbVq0wqx0PhDArTS9zZVWNQVZblqHI7np1Em5On2gqtT4DrClRu3AT9O0VZ1YuT3cz2bVnaQTTY9FXO3oRFHnMmVxqjlQc0B%2FbeUONvaeDja%2F%2B7PvdFF09c4yff3FPWYf7HXQbf8Fw%2F3sBH56%2BePp99MTvseLzhVY5t4LOpZJt%2Bq%2BI37v8nwr6T%2BOCcveUw5%2BOobL%2BfVp7763p%2Fj01Dyzdto3nXXzApP3AonMU4EXCJiNdcJWUdqLcgZj5%2F86CqfbSTz05%2FMIzv0YdybvoM7sRqDWS%2BWvQclii4wczvmlt4LQqBNMSlLrxwk85U8nF7DxVttybgRFeU6bDnVLRVxFXztZBoimw2A1C7srZS6UNmer5Yohz7x3KWcc6FSepLBPS7WdYXY3HJOiayXXT5DrHpGiRLAL2p%2Fr7Yp1qTuGnFqVa6DHpjzDQ%2B1GMweHXcPJp0cYBWjesK0kr8ZDaiNOWxlEtTiy3D2OrK%2F3T3%2FW4lQQG%2F8lQq3gEKgDi2oWa9bbgm0ZRVZ9YzFnW0FRxcPH6V0uP8mSzsK6YmHFwkeVAZtWt1jYEVWLctO1eQ1elv4KJrjaj%2BIMEGon4e%2Bpv1nk6D49jWxXbtU0x47OygkDCNwuQhe2ZTY2z5fWrdVfTeBX%2BM8WbuJxBP0Y0bz5JVuJew6sg7085XJBER0U1y0gu6%2FRHNUYQ4Gayrz7wFC%2Fb59htEIWH77ReLndYHlc2hXusiMCdB95OiILRAFoYXQgv3DfxsQe5YqyCmHgBqMGvKtjuQzWm30B0ua9RacIFIMDAnnvYFqguAIV5TUlUMyaBMqZgdmzCg30QdgnKTPte8LPpIlSB53pJ4lHjYPwok4B7brYVTM9ZevXwNkO58QyZHsALFcxtmLsn2dsy%2BIZu%2Bh1aZWxgVaTz%2BXSOXvfFq2%2F3SH4dAGcbfKNMwTxfhFnN%2Bf70URlrYqzFWcfydk28SISzhbA7JY5WxWnKc6ugbNdnZPZgv2qW%2BVs%2B4ICQIkD%2BpheYAnPygsbtceWXhW%2FRrsSFygscVH%2B1XDjz8PhqGJZzTG%2BSEWhGsWnQzmpH9jgWh7FwwuLxNq0g9E9iwnM7cpLc485kdbpx3SzghHY1RZ5RjauPNeHJXxez0MyBQSBvbabaKls4Vow9b6y9y9Yon6ZzWD0FU5g8IPBLGeLsHPGzsvbCnwu3HCuOSRD%2BmopPm%2FGdjwa1hda%2FF7mSnG5Lj%2BipaIb7S4Vleyh3Cw1sDYf8zGqxXyaY2zV0L8exr70aCYHbkTpea0GM10RX3Nz2LM8%2FULAWJBT7XmiSW4uS78mBNkHL0Mfs%2FTdPf1UyW3YumyR6d1ukr6lK21Ul%2BfuzOagRz2O%2BsAdfZC4xYYfB7ovqd0N6nHXlqkMHoSY8ps02ReEQvoWKm6MEXOEf2xk2Giq66JTtDBabSpTvadM%2BpwHG8AcNKpK28KQFVnaFiY9sUjkdtrCkBsruFmlfLRE4SnUU%2FtGgmkU2ikUjOqitsfFSi4uxE03Gb7kStMSxWK65a6sditNLRV8UD7aOrA7H1fzipzdcsWJKhKshbMPhdWuEjP69v36Iljc4fdsFQhvXcDjDWboK%2BmteLxOHi9sOCBI1W%2BZx1Wb7MuyUVROdNcppHKiB%2F11stt89zQBimk5J9pSteGNo5hLAC8u77Y3qtmgDWIXlQWtvCt1cDZfyCJIz2rXu6Kyaerh7AurYykDJwbL5yLrs906Flv1QGgUm6g6lhNTFLhcGd2RXseiSc5RcK1qWQpD88YgZ%2FLb11A74uy2u%2F9GH2x%2Bn3S3aoID0KRufOMqcCv62sdwE88j%2BPTHJ3wjP0twuBpdH5Y%2FyjlVe8NtQGmK3LVE6Q66vbaX%2BpJM%2FPFex86p9P3OyTUqtI5l79aW42mz8Nf47eR9GSDRGRnlauk5FbKfnvOBnLpftjG6DczG0%2Fm9A1j0SdnObVc0luk1T2Dp5NYPs%2BOx3pRic125eu2k%2FdzwBtAV1RdRhw1v50Z6mpeqNVdq3p7r9ZDatu0MuN37NOsAydvYvo8A1I7T2wMy6Q2OpzZAtAXM2r4xTcm0NntCa6OHa9u0TJbamu5IJrfh9IPcykApNVC%2BwvUymPjYQrlVFkprFgqThP2wd2cLJnyen0mH0sEee%2BSeTd12qEGySZAyWGowWFyNrXPugL3iWb3TchjTGBymAbJBDUk8K9Vynlwt10fz9Cjfamc2GpdM6D5apt3zQ5DIdcepDUgOliRyn0BsVoDL9j%2BY%2FRDfgACIS6kwH1ls9ie3b1wOg9E5HpsDmiLeO3bvNyo39K58p0uZNoz0mffonfDyfUi50AZtPqQzn6bnHkuy1tNwtXKzoga8z4UngOYKUlQsu4j3m0uf1ZSbo9EUlT6mzx5mYr4vtlexo16DuSNq47vGebi3hWyHmdm2wQ1bmOkJ9gRruWiNeHwUPyt%2BPlY4azYnnQW7krbNzpdmo1Rzzws2nm6f5fDvysx54NTDgobNClSgiViw3SIxoMt0h1SL0w9BeV7pgHKS5GF8gYsku1fDTpLKuaaSnSRGZ6hPEoOrOD%2BpSH16qat7B0jeqdC9ackluNoJrVEAReqnT6vGHlEnjNnINOcbck8CZ72d1XMFRWmhpTZ6%2FJh1zNUfJkmfz3SZoI9ImiRFOCd6%2FmoD7m07BIce1%2FlKtG9vDs1b6ekGDFumtqRDR9W1JZfSqJeFj2rUifm2m%2BUVN4Zkrah6mjUqv9PeM9NnpbTOQWkxiY545eF0x2mwaVxFXW6UsVZ4enKg2KGw7AOVGnmfgdcjmgidjktUxuQ%2BwMSVLtuC6JOwAxForp2FITeJblDFu3QALh3ASk4bbqRjEJQjFUGZUh1JFBz%2BRpO3zJEkrRa9OmFNWypdLeUvUv6i%2Fs3quUJv5S%2FaB3%2BAxSXfmCL4066%2FyFJuBeVWULJNuRWUW0G5FXrqVgAWF4exNdHugWLHgqHfNLVzGyA77PQqdWFgHFPKU6fBWbnqMjP5pFmcJNVJPl1Pqs86QNJ2XEZHEFquy8iW2iFGu3FOchk50lxGlQkr2WVky%2B0Gc5JgBjd87x%2FXskto25ny6abojT5GIcZ5%2BbEPCMgsPodTiM%2F4Pw%3D%3D%3C%2Fdiagram%3E%3C%2Fmxfile%3E
